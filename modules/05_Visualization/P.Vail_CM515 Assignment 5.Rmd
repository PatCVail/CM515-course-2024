---
title: "Assignment 5 GG Plot"
author: "Patricia Vail"
output:
  html_document:
    df_print: paged
  pdf_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F, message = F, warning = F)
```

# Instructions 

The aim of this assignment is to provide you with an opportunity to sharpen your skills in using ggplot(). While some of the plots you create may resemble those we covered in class, it is essential that they are original. 
 
 Rules for the Assignment:
 
 1.All data sets except iris are fair game. That includes past data sets used in the class, sets built into R, your own data, and even online data.
 
 2. All graphs must include axis labels, plot title, a theme of your choice, and a brief description/interpretation of the plot (2-3 sentences).


It's worth noting that ggplot() is a widely-used tool, and there are numerous online resources available for you to explore. We strongly recommend that you take advantage of these resources to deepen your understanding of ggplot(). 

Knit the document into a PDF and submit it to Canvas by 02/28/2024 at 11:59 pm.

# Load Packages and Data

*******

```{r}
####
#00#
####
library(knitr)
library(tidyverse)
library(datasets)
library(ggplot2)
library(dplyr)

```



```{r}
f.tit <-  "faithful data: Eruptions of Old Faithful"

ne60 <- round(e60 <- 60 * faithful$eruptions)
all.equal(e60, ne60)             # relative diff. ~ 1/10000
table(zapsmall(abs(e60 - ne60))) # 0, 0.02 or 0.04
faithful$better.eruptions <- ne60 / 60
te <- table(ne60)
te[te >= 4]                      # (too) many multiples of 5 !
plot(names(te), te, type = "h", main = f.tit, xlab = "Eruption time (sec)")

plot(faithful[, -3], main = f.tit,
     xlab = "Eruption time (min)",
     ylab = "Waiting time to next eruption (min)")
lines(lowess(faithful$eruptions, faithful$waiting, f = 2/3, iter = 3),
      col = "red")
```

*******

# 1. Make a Scatter Plot With Customized Point Size and Transparency (3pts)

*******

Description and Interpretation:
This compares the length in time of eruptions vs. the amount of time waiting until the next eruption. The darker data points indicate mutiple observationswithin that area. 

```{r}
####
#01#
####
?faithful
data("faithful")
#head(faithful)
#summary(faithful)

faithful %>%
  ggplot(aes(x = eruptions , y = waiting)) +
   geom_point(size=3, alpha=0.5) +
   theme_classic() +
   labs(x = "Eruption Time (min)", y = "Waiting Time Until Next Eruption (min)",
       title = "Duration of Eruptions vs. Time Until Next Eruption") +
   theme(plot.title = element_text(hjust = 0.5)) 


```

*******

# 2. Fit a Line Through Your Scatter Plot From 1. (3pts)

*******

Description and Interpretation:
The regression line shows that there is a positive correlation between longer eruptions and waiting time until next eruption. IE: the longer the eruption, the longer you will wait till the next one. 

```{r}
#faithful %>%
  #ggplot(aes(x = eruptions , y = waiting)) +
   #geom_point(size=3, alpha=0.5) +
  #geom_smooth()
```

```{r}
####
#02#
####

faithful %>%
  ggplot(aes(x = eruptions , y = waiting)) +
   geom_point(size=3, alpha=0.5) +
   theme_classic() +
   labs(x = "Eruption Time (min)", y = "Waiting Time Until Next Eruption (min)",
       title = "Duration of Eruptions vs. Time Until Next Eruption") +
   theme(plot.title = element_text(hjust = 0.5)) +
   geom_smooth()


```

# 3. Set the transparency, shape, and color of your graph from 1 based on expressions. Scale the color. (3pts)

*******

Description and Interpretation:
This compares the length in time of eruptions vs. the amount of time waiting until the next eruption. The triangles denote an eruption time of greater than 3.3 minutes, the color is scaled with the duration of the waiting time. 

```{r}
####
#03#
####
faithful %>%
  ggplot() +
    theme_classic() +
    aes(x = eruptions , y = waiting) +
#    geom_point(size = 3, alpha = .5,  aes(color = cut(waiting, breaks=c(40, 50, 60, 70, 80, 90, 100)), shape = eruptions > 3.3)) +
    geom_point(size = 3, alpha = .5, aes(color = waiting, shape = eruptions > 3.3)) +
    geom_smooth() +
    labs(x = "Eruption Time (min)", y = "Waiting Time Until Next Eruption (min)",
         title = "Duration of Eruptions vs. Time Until Next Eruption") +
    theme(plot.title = element_text(hjust = 0.5))
```

*******

# 4. Make a Boxplot With Customized Boxplot Width (3pts)

*******


Description and Interpretation:
This boxplot groups the length of the eruption into >3.3 minutes and < 3.3 minutes and compares each group to the amount of time until the next eruption occurs. 

```{r}
####
#04#
####
#faithful$erupt_gt_3 <- factor(faithful$eruptions > 3.3)
data("faithful")
faithful %>%
  ggplot(aes(x = ifelse(faithful$eruptions > 3.3, "Eruptions > 3.3", "Eruptions <= 3.3"), y = waiting)) +
  labs(x = 'Eruptions (min)', y = "Waiting Time Until Next Eruption (min)",
         title = "Waiting Time Until Next Eruption Based on Eruption Length") +
  theme(plot.title = element_text(hjust = 0.5)) +
  geom_boxplot(staplewidth = .2)
```

*******

# 5. Overlay the Individual Points Over Your Box Plot From 3. and Adjust the Point Size and Transparency as Needed (3pts)

******

Description and Interpretation:
Just looking at the boxplots gives very little information about the individual eruptions. By overlaying the individual data points, you are easily able to see that there are more eruptions above 3 minutes. 

```{r}
####
#05#
####
faithful %>%
  ggplot(aes(x = ifelse(faithful$eruptions > 3.3, "Eruptions > 3.3", "Eruptions <= 3.3"), y = waiting)) +
  labs(x = 'Eruptions (min)', y = "Waiting Time Until Next Eruption (min)",
         title = "Waiting Time Until Next Eruption Based on Eruption Length") +
  theme(plot.title = element_text(hjust = 0.5)) +
  geom_jitter(size = 2.6, alpha = 0.5, color = "sienna2") +
  #geom_point(aes(fill = waiting), position = position_jitterdodge(), alpha = 0.5) +
  geom_boxplot(staplewidth = .2, alpha = 0) 
  


```

# 6. Make a plot and modify the scale in a beneficial way using scale_x_continuous(), scale_y_continuous(), and coordinate_cartesian(). Explain how your modifications to the scales improved the plot. (4pts)

******

Description and Interpretation:
If you were interested in just visualizing the eruptions with the longest length of time, you can zoom in on the plot using the coord_cartesian and redefining the x and y scales for a more granular visualization. 

```{r}
####
#06#
####

faithful %>%
  ggplot(aes(x = eruptions , y = waiting)) +
   geom_point(size=3, alpha=0.5, color = "darkgreen") +
   theme_light() +
   labs(x = "Eruption Time (min)", y = "Waiting Time Until Next Eruption (min)",
       title = "Duration of Eruptions vs. Time Until Next Eruption") +
   theme(plot.title = element_text(hjust = 0.5)) +
   scale_x_continuous (name= "Eruptions (min)", breaks=c(1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5),limits = c(1.5, 5.5)) +
   scale_y_continuous(name="Waiting Time (min)", breaks = c( 60, 70, 80, 90, 100), limits=c(60,100))+
   coord_cartesian(xlim = c(3 ,5.25) , ylim = NULL, expand = TRUE, default = FALSE,clip = "on")


 

```

******

# 7. Make a New (don't use any plots from 1-4) Plot with facet_wrap() (4pts)

******


Description and Interpretation:
In order to do facet wrapping, I needed a new set of data with more variables. I choose the CO2 data which looks at plant CO2 uptake at different ambient CO2 levels under chilled and non-chilled treatments in two different locations. The facet wrapping allows you to look at each observation for each plant individually.  

```{r}
#07#
####
#your code here
CO2 %>%
  ggplot(aes(x = conc , y = uptake, color = Treatment)) +
   geom_jitter(size=3, alpha=0.5, ) +
   theme_classic() +
   labs(x = "CO2 Ambient Concentration", y = "CO2 Uptake",
       title = "CO2 Uptake vs Ambient CO2 of Plants in Quebec & Mississippi") +
   theme(plot.title = element_text(hjust = 0.5)) +
  scale_color_brewer("Treatment", palette="Dark2") +
  facet_wrap("Plant")


```







# 8. Using the plot from 5, scale the colors and reorder your facet to reverse order. (4pts)

******

Description and Interpretation:
In this facet wrap plot, I have added colors to distinguish each plant, a line to visualize the trend of CO2 uptake increasing as ambient CO2 increases and reordered the faceting wrapping in the reverse. 

```{r}
#08#
####
#your code here
CO2 %>%
  ggplot(aes(x = conc , y = uptake, color = Plant)) +
   geom_line(linewidth = 0.5) +
  geom_point(size=3, alpha=0.5, ) +
   theme_classic() +
   labs(x = "CO2 Ambient Concentration", y = "CO2 Uptake",
       title = "CO2 Uptake of Plants in Quecbec (Qn) vs Mississippi (Mn)") +
   theme(plot.title = element_text(hjust = 0.5)) +
  scale_color_manual(values=c( "brown", "red3", "yellow3", "steelblue3", "orange2", "purple3", "green2","black", "blue", "pink","tan","yellow" ), name = "Plant",      breaks=c("Qn1","Qn2","Qn3","Qc1","Qc2","Qc3","Mn1","Mn2","Mn3","Mc1", "Mc2", "Mc3"), limits = c("Qn1","Qn2","Qn3","Qc1","Qc2","Qc3","Mn1","Mn2","Mn3","Mc1", "Mc2", "Mc3"))+
  facet_wrap(~Plant) +
  facet_wrap(~factor(Plant, levels=c("Mc3","Mc2","Mc1","Mn3","Mn2","Mn1","Qc3","Qc2","Qc1","Qn3","Qn2","Qn1")))

```

******

# 9. Make a Plot Using a Geometry That Was Not Covered in Class (4pts)

******

Description and Interpretation:
The geom_hex is an alternative to geom_point when there are a lot of points to be plotted and can make the graph look overplotted and messy. This geometry divides the entire graph plane into hexagons and then figures out how many points are in each hexagon and mapss it with am ascending color fill. This would be particularly useful for a graph with lots of points ( maybe not this one) but still looks pretty cool. 

```{r}
####
#09#
####
#your code here 
faithful %>%
  ggplot(aes(x = eruptions , y = waiting)) +
   geom_hex(binwidth = c(.1,2)) +
   theme_bw() +
   labs(x = "Eruption Time (min)", y = "Waiting Time Until Next Eruption (min)",
       title = "Duration of Eruptions vs. Time Until Next Eruption") +
   theme(plot.title = element_text(hjust = 0.5)) 
```

# 10. Make a Plot Using a ggplot Extension That Was Not Covered in Class. Explain what the extension does. (4pts)

******

Description and Interpretation:
I installed the package ggbeeswarm for this plot. This is a way of visulizing all of your points without overlap. This creates a plot similar to a violin plt and eliminates the need for alpha setting which can be ambiguous. 

```{r}
####
#10#
####

install.packages('ggbeeswarm', repos = "http://cran.us.r-project.org")
library(ggbeeswarm)

faithful %>%
  ggplot(aes(x = ifelse(eruptions > 3.3, "Eruptions > 3.3", "Eruptions <= 3.3"), y = waiting)) +
  labs(x = 'Eruptions (min)', y = "Waiting Time Until Next Eruption (min)",
         title = "Waiting Time Until Next Eruption Based on Eruption Length") +
  theme(plot.title = element_text(hjust = 0.5)) +
  geom_quasirandom(size = 2.6, alpha = 0.5, color = "sienna2") +
  #geom_point(aes(fill = waiting), position = position_jitterdodge(), alpha = 0.5) +
  geom_boxplot(staplewidth = .2, alpha = 0) 

```

******

# Appendix

```{r show-code, ref.label = all_labels(), echo = TRUE, eval = FALSE}

```



